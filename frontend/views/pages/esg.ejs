<%
// Safe defaults for all potentially undefined variables
const safeTheme = typeof theme !== 'undefined' ? theme : 'dark';
const safeUser = typeof user !== 'undefined' ? user : {};
const safePageTitle = 'ESG Ratings';
%>
<%- include('../partials/header', { pageTitle: safePageTitle }) %>

<!-- Bloomberg Header Bar -->
<div class="bg-black border-b-2 border-amber-400 px-6 py-3 -mx-6 -mt-6 mb-6">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold text-amber-400 font-mono tracking-tight">ESG RATINGS</h1>
      <p class="text-slate-400 text-sm mt-1">Environmental, Social & Governance Analysis</p>
    </div>
    <select class="bg-slate-900 border border-slate-700 text-white px-4 py-2 rounded font-mono text-sm hover:border-amber-400 transition-colors">
      <option>All Holdings</option>
      <option>Low ESG Risk</option>
      <option>High ESG Risk</option>
    </select>
  </div>
</div>

<!-- KPI Bar -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
  <div class="bg-black border border-emerald-500/30 p-4">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-slate-400 text-xs font-mono mb-1">ENVIRONMENTAL</p>
        <p class="text-3xl font-bold text-emerald-400 font-mono">68</p>
      </div>
      <div class="text-emerald-400 text-2xl">üåø</div>
    </div>
    <div class="h-1 bg-slate-800 mt-3">
      <div class="h-1 bg-emerald-400" style="width:68%"></div>
    </div>
  </div>

  <div class="bg-black border border-sky-500/30 p-4">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-slate-400 text-xs font-mono mb-1">SOCIAL</p>
        <p class="text-3xl font-bold text-sky-400 font-mono">75</p>
      </div>
      <div class="text-sky-400 text-2xl">üë•</div>
    </div>
    <div class="h-1 bg-slate-800 mt-3">
      <div class="h-1 bg-sky-400" style="width:75%"></div>
    </div>
  </div>

  <div class="bg-black border border-purple-500/30 p-4">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-slate-400 text-xs font-mono mb-1">GOVERNANCE</p>
        <p class="text-3xl font-bold text-purple-400 font-mono">78</p>
      </div>
      <div class="text-purple-400 text-2xl">üèõÔ∏è</div>
    </div>
    <div class="h-1 bg-slate-800 mt-3">
      <div class="h-1 bg-purple-400" style="width:78%"></div>
    </div>
  </div>
</div>

<!-- Portfolio ESG Summary -->
<div class="bloomberg-card p-6">
  <div class="border-l-4 border-amber-400 pl-4 mb-6">
    <h2 class="text-sm font-mono text-slate-400 mb-1">PORTFOLIO ESG SCORE</h2>
    <div class="flex items-end gap-3">
      <p class="text-5xl font-bold text-amber-400 font-mono">72</p>
      <p class="text-lg text-emerald-400 font-mono mb-2">ABOVE AVERAGE</p>
    </div>
  </div>
</div>

<!-- ESG Leaders & Laggards -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <div class="bloomberg-card p-5">
    <div class="border-l-4 border-emerald-400 pl-4 mb-4">
      <h3 class="font-mono text-sm text-emerald-400 flex items-center gap-2">üèÜ ESG LEADERS</h3>
    </div>
    <div class="space-y-3">
      <div class="flex items-center justify-between p-3 bg-emerald-500/10 border border-emerald-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-emerald-500 flex items-center justify-center text-black text-xs font-bold font-mono">MSFT</div>
          <div>
            <p class="font-bold text-white">Microsoft</p>
            <p class="text-xs text-slate-400">Carbon negative by 2030</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-emerald-400 font-mono">92</p>
          <p class="text-xs text-emerald-400 font-mono">AAA</p>
        </div>
      </div>
      <div class="flex items-center justify-between p-3 bg-emerald-500/10 border border-emerald-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-sky-500 flex items-center justify-center text-black text-xs font-bold font-mono">AAPL</div>
          <div>
            <p class="font-bold text-white">Apple</p>
            <p class="text-xs text-slate-400">100% renewable energy</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-emerald-400 font-mono">88</p>
          <p class="text-xs text-emerald-400 font-mono">AA</p>
        </div>
      </div>
      <div class="flex items-center justify-between p-3 bg-emerald-500/10 border border-emerald-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-amber-500 flex items-center justify-center text-black text-xs font-bold font-mono">JNJ</div>
          <div>
            <p class="font-bold text-white">Johnson & Johnson</p>
            <p class="text-xs text-slate-400">Strong governance</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-emerald-400 font-mono">85</p>
          <p class="text-xs text-emerald-400 font-mono">AA</p>
        </div>
      </div>
    </div>
  </div>

  <div class="bloomberg-card p-5">
    <div class="border-l-4 border-red-400 pl-4 mb-4">
      <h3 class="font-mono text-sm text-red-400 flex items-center gap-2">‚ö†Ô∏è ESG LAGGARDS</h3>
    </div>
    <div class="space-y-3">
      <div class="flex items-center justify-between p-3 bg-red-500/10 border border-red-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-red-500 flex items-center justify-center text-black text-xs font-bold font-mono">XOM</div>
          <div>
            <p class="font-bold text-white">Exxon Mobil</p>
            <p class="text-xs text-slate-400">High carbon emissions</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-red-400 font-mono">32</p>
          <p class="text-xs text-red-400 font-mono">CCC</p>
        </div>
      </div>
      <div class="flex items-center justify-between p-3 bg-amber-500/10 border border-amber-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-amber-500 flex items-center justify-center text-black text-xs font-bold font-mono">META</div>
          <div>
            <p class="font-bold text-white">Meta Platforms</p>
            <p class="text-xs text-slate-400">Privacy concerns</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-amber-400 font-mono">54</p>
          <p class="text-xs text-amber-400 font-mono">BB</p>
        </div>
      </div>
      <div class="flex items-center justify-between p-3 bg-amber-500/10 border border-amber-500/20">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-purple-500 flex items-center justify-center text-black text-xs font-bold font-mono">AMZN</div>
          <div>
            <p class="font-bold text-white">Amazon</p>
            <p class="text-xs text-slate-400">Labor practices</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-amber-400 font-mono">58</p>
          <p class="text-xs text-amber-400 font-mono">BBB</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Holdings ESG Table -->
<div class="bloomberg-card overflow-hidden">
  <div class="p-4 border-b border-slate-700">
    <h3 class="font-mono text-sm text-amber-400">ALL HOLDINGS ESG BREAKDOWN</h3>
  </div>
  <table class="w-full text-sm">
    <thead>
      <tr class="bg-slate-900 text-slate-400 text-left font-mono text-xs">
        <th class="px-4 py-3">STOCK</th>
        <th class="px-4 py-3 text-center">OVERALL</th>
        <th class="px-4 py-3 text-center">üåø E</th>
        <th class="px-4 py-3 text-center">üë• S</th>
        <th class="px-4 py-3 text-center">üèõÔ∏è G</th>
        <th class="px-4 py-3">CONTROVERSIES</th>
        <th class="px-4 py-3">RATING</th>
      </tr>
    </thead>
    <tbody class="text-white">
      <tr class="border-b border-slate-800 hover:bg-slate-900/50">
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-emerald-500 flex items-center justify-center text-black text-xs font-bold font-mono">MSFT</div>
            <span class="font-medium">Microsoft</span>
          </div>
        </td>
        <td class="px-4 py-3 text-center font-bold text-emerald-400 font-mono">92</td>
        <td class="px-4 py-3 text-center font-mono">95</td>
        <td class="px-4 py-3 text-center font-mono">88</td>
        <td class="px-4 py-3 text-center font-mono">92</td>
        <td class="px-4 py-3"><span class="px-2 py-1 bg-emerald-500/20 text-emerald-400 text-xs font-mono">None</span></td>
        <td class="px-4 py-3 font-bold text-emerald-400 font-mono">AAA</td>
      </tr>
      <tr class="border-b border-slate-800 hover:bg-slate-900/50">
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-sky-500 flex items-center justify-center text-black text-xs font-bold font-mono">AAPL</div>
            <span class="font-medium">Apple</span>
          </div>
        </td>
        <td class="px-4 py-3 text-center font-bold text-emerald-400 font-mono">88</td>
        <td class="px-4 py-3 text-center font-mono">92</td>
        <td class="px-4 py-3 text-center font-mono">82</td>
        <td class="px-4 py-3 text-center font-mono">88</td>
        <td class="px-4 py-3"><span class="px-2 py-1 bg-amber-500/20 text-amber-400 text-xs font-mono">1 Minor</span></td>
        <td class="px-4 py-3 font-bold text-emerald-400 font-mono">AA</td>
      </tr>
      <tr class="border-b border-slate-800 hover:bg-slate-900/50">
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-purple-500 flex items-center justify-center text-black text-xs font-bold font-mono">NVDA</div>
            <span class="font-medium">NVIDIA</span>
          </div>
        </td>
        <td class="px-4 py-3 text-center font-bold text-sky-400 font-mono">76</td>
        <td class="px-4 py-3 text-center font-mono">72</td>
        <td class="px-4 py-3 text-center font-mono">78</td>
        <td class="px-4 py-3 text-center font-mono">80</td>
        <td class="px-4 py-3"><span class="px-2 py-1 bg-emerald-500/20 text-emerald-400 text-xs font-mono">None</span></td>
        <td class="px-4 py-3 font-bold text-sky-400 font-mono">A</td>
      </tr>
      <tr class="border-b border-slate-800 hover:bg-slate-900/50">
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-amber-500 flex items-center justify-center text-black text-xs font-bold font-mono">META</div>
            <span class="font-medium">Meta</span>
          </div>
        </td>
        <td class="px-4 py-3 text-center font-bold text-amber-400 font-mono">54</td>
        <td class="px-4 py-3 text-center font-mono">68</td>
        <td class="px-4 py-3 text-center font-mono">42</td>
        <td class="px-4 py-3 text-center font-mono">58</td>
        <td class="px-4 py-3"><span class="px-2 py-1 bg-red-500/20 text-red-400 text-xs font-mono">3 Major</span></td>
        <td class="px-4 py-3 font-bold text-amber-400 font-mono">BB</td>
      </tr>
      <tr class="border-b border-slate-800 hover:bg-slate-900/50">
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-red-500 flex items-center justify-center text-black text-xs font-bold font-mono">XOM</div>
            <span class="font-medium">Exxon</span>
          </div>
        </td>
        <td class="px-4 py-3 text-center font-bold text-red-400 font-mono">32</td>
        <td class="px-4 py-3 text-center font-mono">18</td>
        <td class="px-4 py-3 text-center font-mono">45</td>
        <td class="px-4 py-3 text-center font-mono">42</td>
        <td class="px-4 py-3"><span class="px-2 py-1 bg-red-500/20 text-red-400 text-xs font-mono">5 Major</span></td>
        <td class="px-4 py-3 font-bold text-red-400 font-mono">CCC</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- ESG Improvement Suggestions -->
<div class="bloomberg-card p-5">
  <div class="border-l-4 border-amber-400 pl-4 mb-4">
    <h3 class="font-mono text-sm text-amber-400">üí° ESG IMPROVEMENT SUGGESTIONS</h3>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="p-4 bg-emerald-500/10 border border-emerald-500/20">
      <p class="font-bold text-emerald-400 mb-2 font-mono">Replace XOM with NEE</p>
      <p class="text-sm text-slate-400">NextEra Energy has ESG score of <span class="font-mono text-emerald-400">84</span> vs XOM's <span class="font-mono text-red-400">32</span>. Similar dividend yield.</p>
      <button class="bloomberg-btn-secondary mt-3 w-full">
        <span class="font-mono text-xs">ANALYZE SWAP</span>
      </button>
    </div>
    <div class="p-4 bg-sky-500/10 border border-sky-500/20">
      <p class="font-bold text-sky-400 mb-2 font-mono">Add More Clean Tech</p>
      <p class="text-sm text-slate-400">Consider <span class="font-mono text-sky-400">ENPH</span>, <span class="font-mono text-sky-400">FSLR</span> for renewable energy exposure.</p>
      <button class="bloomberg-btn-secondary mt-3 w-full">
        <span class="font-mono text-xs">VIEW OPTIONS</span>
      </button>
    </div>
    <div class="p-4 bg-purple-500/10 border border-purple-500/20">
      <p class="font-bold text-purple-400 mb-2 font-mono">Reduce META Position</p>
      <p class="text-sm text-slate-400">Privacy controversies impact ESG. Consider <span class="font-mono text-purple-400">CRM</span> instead.</p>
      <button class="bloomberg-btn-secondary mt-3 w-full">
        <span class="font-mono text-xs">COMPARE</span>
      </button>
    </div>
  </div>
</div>
</div></div></main>
<%- include('../partials/footer') %>
