<!-- WealthPilot Pro - Bloomberg Style Top Navigation -->
<nav class="topnav">
  <div class="topnav-inner">
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" aria-label="Open menu">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18"/>
      </svg>
    </button>

    <!-- Logo -->
    <a href="/" class="topnav-logo">
      <div class="topnav-logo-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
        </svg>
      </div>
      <span class="topnav-logo-text">Wealth<span>Pilot</span></span>
    </a>

    <!-- Main Navigation Menu -->
    <div class="topnav-menu">
      <div class="topnav-item" data-menu="markets">
        Markets
        <span class="topnav-item-icon">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>
      <div class="topnav-item" data-menu="portfolio">
        Portfolio
        <span class="topnav-item-icon">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>
      <div class="topnav-item" data-menu="analysis">
        Analysis
        <span class="topnav-item-icon">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>
      <div class="topnav-item" data-menu="tools">
        Tools
        <span class="topnav-item-icon">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>
      <div class="topnav-item" data-menu="research">
        Research
        <span class="topnav-item-icon">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>
    </div>

    <!-- Right Side Actions -->
    <div class="topnav-actions">
      <!-- Market Ticker -->
      <div class="topnav-ticker">
        <div class="topnav-ticker-item">
          <span class="topnav-ticker-symbol">SPY</span>
          <span class="topnav-ticker-change up">+0.45%</span>
        </div>
        <div class="topnav-ticker-item">
          <span class="topnav-ticker-symbol">QQQ</span>
          <span class="topnav-ticker-change up">+0.72%</span>
        </div>
        <div class="topnav-ticker-item">
          <span class="topnav-ticker-symbol">DIA</span>
          <span class="topnav-ticker-change down">-0.12%</span>
        </div>
      </div>

      <!-- Search Button -->
      <button class="topnav-search" onclick="openCommandPalette && openCommandPalette()">
        <svg class="topnav-search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
        <span class="topnav-search-text">Search</span>
        <span class="topnav-search-kbd">Ctrl+K</span>
      </button>

      <!-- Notifications -->
      <button class="topnav-notification" aria-label="Notifications">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
        <span class="topnav-notification-badge">3</span>
      </button>

      <!-- User Menu -->
      <div class="topnav-user-wrapper" style="position: relative;">
        <button class="topnav-user">
          <div class="topnav-user-avatar"><%= user?.firstName?.charAt(0) || 'U' %><%= user?.lastName?.charAt(0) || '' %></div>
          <span class="topnav-user-name"><%= user?.firstName || 'User' %></span>
          <svg class="topnav-user-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>

        <!-- Account Dropdown -->
        <div class="account-dropdown">
          <div class="account-dropdown-header">
            <div class="account-dropdown-name"><%= user?.firstName || 'Demo' %> <%= user?.lastName || 'User' %></div>
            <div class="account-dropdown-email"><%= user?.email || 'demo@wealthpilot.com' %></div>
          </div>
          <div class="account-dropdown-links">
            <a href="/settings" class="account-dropdown-link">
              <svg class="account-dropdown-link-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
              </svg>
              Settings
            </a>
            <a href="/profile" class="account-dropdown-link">
              <svg class="account-dropdown-link-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
              Profile
            </a>
            <a href="/tax" class="account-dropdown-link">
              <svg class="account-dropdown-link-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <path d="M14 2v6h6"/>
                <path d="M16 13H8"/>
                <path d="M16 17H8"/>
                <path d="M10 9H8"/>
              </svg>
              Tax Center
            </a>
            <a href="/export" class="account-dropdown-link">
              <svg class="account-dropdown-link-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Export Data
            </a>
            <div class="account-dropdown-divider"></div>
            <a href="/logout" class="account-dropdown-link danger">
              <svg class="account-dropdown-link-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                <polyline points="16 17 21 12 16 7"/>
                <line x1="21" y1="12" x2="9" y2="12"/>
              </svg>
              Logout
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Mega Menu Container -->
<div id="megamenu" class="megamenu">
  <div class="megamenu-inner" id="megamenu-content">
    <!-- Content loaded dynamically by JavaScript -->
  </div>
</div>

<!-- Mobile Menu Overlay -->
<div class="mobile-menu-overlay">
  <div class="mobile-menu-panel">
    <div class="mobile-menu-header">
      <span class="mobile-menu-title">Menu</span>
      <button class="mobile-menu-close" aria-label="Close menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation Sections -->
    <div class="mobile-menu-nav">
      <div class="mobile-menu-section">
        <button class="mobile-menu-trigger">
          Markets
          <svg class="mobile-menu-trigger-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>
        <div class="mobile-menu-content">
          <a href="/market" class="mobile-menu-link">Market Dashboard</a>
          <a href="/market-breadth" class="mobile-menu-link">Market Breadth</a>
          <a href="/sectors" class="mobile-menu-link">Sectors</a>
          <a href="/sector-rotation" class="mobile-menu-link">Sector Rotation</a>
          <a href="/economic-calendar" class="mobile-menu-link">Economic Calendar</a>
          <a href="/earnings-calendar" class="mobile-menu-link">Earnings Calendar</a>
        </div>
      </div>

      <div class="mobile-menu-section">
        <button class="mobile-menu-trigger">
          Portfolio
          <svg class="mobile-menu-trigger-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>
        <div class="mobile-menu-content">
          <a href="/" class="mobile-menu-link">Portfolio Dashboard</a>
          <a href="/portfolio" class="mobile-menu-link">Overview</a>
          <a href="/holdings" class="mobile-menu-link">Holdings</a>
          <a href="/watchlist" class="mobile-menu-link">Watchlist</a>
          <a href="/transactions" class="mobile-menu-link">Transactions</a>
          <a href="/performance" class="mobile-menu-link">Performance</a>
          <a href="/attribution" class="mobile-menu-link">Attribution</a>
        </div>
      </div>

      <div class="mobile-menu-section">
        <button class="mobile-menu-trigger">
          Analysis
          <svg class="mobile-menu-trigger-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>
        <div class="mobile-menu-content">
          <a href="/analytics" class="mobile-menu-link">Analytics</a>
          <a href="/dividends" class="mobile-menu-link">Dividends</a>
          <a href="/risk" class="mobile-menu-link">Risk Analysis</a>
          <a href="/technicals" class="mobile-menu-link">Technical Analysis</a>
          <a href="/options-chain" class="mobile-menu-link">Options</a>
          <a href="/research" class="mobile-menu-link">Research</a>
        </div>
      </div>

      <div class="mobile-menu-section">
        <button class="mobile-menu-trigger">
          Tools
          <svg class="mobile-menu-trigger-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>
        <div class="mobile-menu-content">
          <a href="/investment-selector" class="mobile-menu-link" style="color: #f59e0b; font-weight: 600;">â˜… Investment Selector</a>
          <a href="/alerts" class="mobile-menu-link">Alerts</a>
          <a href="/scanner" class="mobile-menu-link">Scanner</a>
          <a href="/etf-analyzer" class="mobile-menu-link">ETF Analyzer</a>
          <a href="/rebalancer" class="mobile-menu-link">Rebalancer</a>
          <a href="/calculators" class="mobile-menu-link">Calculators</a>
          <a href="/paper-trading" class="mobile-menu-link">Paper Trading</a>
          <a href="/assistant" class="mobile-menu-link">AI Assistant</a>
        </div>
      </div>

      <div class="mobile-menu-section">
        <button class="mobile-menu-trigger">
          Research
          <svg class="mobile-menu-trigger-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </button>
        <div class="mobile-menu-content">
          <a href="/news" class="mobile-menu-link">News</a>
          <a href="/reports" class="mobile-menu-link">AI Reports</a>
          <a href="/social" class="mobile-menu-link">Social</a>
          <a href="/forum" class="mobile-menu-link">Forum</a>
          <a href="/education" class="mobile-menu-link">Education</a>
        </div>
      </div>
    </div>

    <!-- Mobile Menu Footer -->
    <div class="mobile-menu-footer">
      <div class="mobile-menu-user">
        <div class="mobile-menu-user-avatar"><%= user?.firstName?.charAt(0) || 'D' %><%= user?.lastName?.charAt(0) || 'U' %></div>
        <div class="mobile-menu-user-info">
          <div class="mobile-menu-user-name"><%= user?.firstName || 'Demo' %> <%= user?.lastName || 'User' %></div>
          <div class="mobile-menu-user-plan">Pro Plan</div>
        </div>
      </div>
      <a href="/logout" class="mobile-menu-logout">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        Logout
      </a>
    </div>
  </div>
</div>
