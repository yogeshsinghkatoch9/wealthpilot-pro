[build]
builder = "nixpacks"
# Updated 2025-12-20T02:10:00Z - trigger redeploy for portfolio upload fix
buildCommand = "cd backend && npm install --legacy-peer-deps && npm rebuild better-sqlite3 || true"

[deploy]
startCommand = "cd backend && npm start"
healthcheckPath = "/health"
healthcheckTimeout = 60
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 5

[env]
NODE_ENV = "production"
PORT = "4000"
# Force PostgreSQL adapter (DATABASE_URL will be set by Railway PostgreSQL service)
DATABASE_TYPE = "postgresql"
