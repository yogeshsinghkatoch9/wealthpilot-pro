<%
// Safe defaults for all potentially undefined variables
const safeTheme = typeof theme !== 'undefined' ? theme : 'dark';
%>
<%- include('../partials/header', { pageTitle: 'Debt Analysis' }) %>

<!-- Bloomberg Header Bar -->
<div class="bloomberg-header mb-6">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-amber-400">DEBT ANALYSIS</h1>
      <p class="text-slate-400">Debt ratios, interest coverage & maturities</p>
    </div>
    <div class="flex gap-2">
      <input type="text" value="AAPL" class="form-input w-24 font-mono">
      <button class="bloomberg-btn">Analyze</button>
    </div>
  </div>
</div>

<!-- Company Header -->
<div class="bloomberg-card p-5">
  <div class="flex items-center gap-4">
    <div class="w-14 h-14 rounded bg-slate-700 flex items-center justify-center text-white font-bold text-xl">AAPL</div>
    <div class="flex-1">
      <h2 class="text-xl font-bold text-white">Apple Inc.</h2>
      <p class="text-slate-400">Credit Rating: AA+ (S&P) / Aa1 (Moody's)</p>
    </div>
    <div class="text-center px-4 border-l border-slate-700">
      <p class="text-sm text-slate-400">Total Debt</p>
      <p class="text-xl font-bold font-mono tabular-nums text-white">$111.1B</p>
    </div>
    <div class="text-center px-4 border-l border-slate-700">
      <p class="text-sm text-slate-400">Debt Health</p>
      <p class="text-xl font-bold positive">Excellent</p>
    </div>
  </div>
</div>

<!-- Debt Metrics -->
<div class="grid grid-cols-2 md:grid-cols-5 gap-4">
  <div class="tufte-stat-card">
    <p class="text-slate-400 text-sm">Debt/Equity</p>
    <p class="text-2xl font-bold font-mono tabular-nums text-white">1.81</p>
    <p class="text-xs text-slate-400">Below sector avg 2.4</p>
  </div>
  <div class="tufte-stat-card">
    <p class="text-slate-400 text-sm">Debt/EBITDA</p>
    <p class="text-2xl font-bold font-mono tabular-nums text-white">0.86</p>
    <p class="text-xs text-slate-400">Very low leverage</p>
  </div>
  <div class="tufte-stat-card">
    <p class="text-slate-400 text-sm">Interest Coverage</p>
    <p class="text-2xl font-bold font-mono tabular-nums positive">29.8x</p>
    <p class="text-xs text-slate-400">Excellent coverage</p>
  </div>
  <div class="tufte-stat-card">
    <p class="text-slate-400 text-sm">Net Debt</p>
    <p class="text-2xl font-bold font-mono tabular-nums text-white">$81.2B</p>
    <p class="text-xs text-slate-400">Cash: $29.9B</p>
  </div>
  <div class="tufte-stat-card">
    <p class="text-slate-400 text-sm">Avg Interest Rate</p>
    <p class="text-2xl font-bold font-mono tabular-nums text-white">3.2%</p>
    <p class="text-xs text-slate-400">Low cost debt</p>
  </div>
</div>

<!-- Debt Structure -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <div class="bloomberg-card p-5">
    <h3 class="font-semibold text-amber-400 mb-4">Debt Composition</h3>
    <div class="h-64"><canvas id="debtChart"></canvas></div>
  </div>
  <div class="bloomberg-card p-5">
    <h3 class="font-semibold text-amber-400 mb-4">Debt Maturity Profile</h3>
    <div class="h-64"><canvas id="maturityChart"></canvas></div>
  </div>
</div>

<!-- Debt Schedule -->
<div class="bloomberg-card overflow-hidden">
  <div class="p-4 border-b border-slate-700">
    <h3 class="font-semibold text-amber-400">Upcoming Debt Maturities</h3>
  </div>
  <table class="w-full text-sm">
    <thead>
      <tr class="bg-slate-800 text-slate-400 text-left">
        <th class="px-4 py-3">Maturity Date</th>
        <th class="px-4 py-3">Type</th>
        <th class="px-4 py-3 text-center">Principal</th>
        <th class="px-4 py-3 text-center">Coupon</th>
        <th class="px-4 py-3 text-center">Annual Interest</th>
        <th class="px-4 py-3">Status</th>
      </tr>
    </thead>
    <tbody class="text-white">
      <tr class="border-b border-slate-700/50">
        <td class="px-4 py-3 font-medium">Feb 2025</td>
        <td class="px-4 py-3">Senior Notes</td>
        <td class="px-4 py-3 text-center font-mono">$2.0B</td>
        <td class="px-4 py-3 text-center font-mono">2.40%</td>
        <td class="px-4 py-3 text-center font-mono">$48M</td>
        <td class="px-4 py-3"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs">Due Soon</span></td>
      </tr>
      <tr class="border-b border-slate-700/50">
        <td class="px-4 py-3 font-medium">May 2025</td>
        <td class="px-4 py-3">Senior Notes</td>
        <td class="px-4 py-3 text-center font-mono">$1.5B</td>
        <td class="px-4 py-3 text-center font-mono">1.80%</td>
        <td class="px-4 py-3 text-center font-mono">$27M</td>
        <td class="px-4 py-3"><span class="px-2 py-1 rounded bg-sky-500/20 text-sky-400 text-xs">6 Months</span></td>
      </tr>
      <tr class="border-b border-slate-700/50">
        <td class="px-4 py-3 font-medium">Sep 2025</td>
        <td class="px-4 py-3">Senior Notes</td>
        <td class="px-4 py-3 text-center font-mono">$3.5B</td>
        <td class="px-4 py-3 text-center font-mono">2.85%</td>
        <td class="px-4 py-3 text-center font-mono">$100M</td>
        <td class="px-4 py-3"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">9 Months</span></td>
      </tr>
      <tr class="border-b border-slate-700/50">
        <td class="px-4 py-3 font-medium">Feb 2026</td>
        <td class="px-4 py-3">Senior Notes</td>
        <td class="px-4 py-3 text-center font-mono">$4.0B</td>
        <td class="px-4 py-3 text-center font-mono">3.25%</td>
        <td class="px-4 py-3 text-center font-mono">$130M</td>
        <td class="px-4 py-3"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">14 Months</span></td>
      </tr>
      <tr class="border-b border-slate-700/50">
        <td class="px-4 py-3 font-medium">Aug 2027</td>
        <td class="px-4 py-3">Senior Notes</td>
        <td class="px-4 py-3 text-center font-mono">$5.5B</td>
        <td class="px-4 py-3 text-center font-mono">3.45%</td>
        <td class="px-4 py-3 text-center font-mono">$190M</td>
        <td class="px-4 py-3"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">2+ Years</span></td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Comparison & Analysis -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <div class="bloomberg-card p-5">
    <h3 class="font-semibold text-amber-400 mb-4">Debt Ratio Comparison</h3>
    <div class="space-y-4">
      <div>
        <div class="flex justify-between mb-1 text-white">
          <span>AAPL Debt/Equity</span>
          <span class="font-bold font-mono text-emerald-400">1.81</span>
        </div>
        <div class="h-3 rounded-full bg-slate-700">
          <div class="h-3 rounded-full bg-emerald-500" style="width:36%"></div>
        </div>
      </div>
      <div>
        <div class="flex justify-between mb-1 text-white">
          <span>Sector Average</span>
          <span class="font-bold font-mono text-amber-400">2.42</span>
        </div>
        <div class="h-3 rounded-full bg-slate-700">
          <div class="h-3 rounded-full bg-amber-500" style="width:48%"></div>
        </div>
      </div>
      <div>
        <div class="flex justify-between mb-1 text-white">
          <span>MSFT</span>
          <span class="font-bold font-mono text-emerald-400">0.42</span>
        </div>
        <div class="h-3 rounded-full bg-slate-700">
          <div class="h-3 rounded-full bg-sky-500" style="width:8%"></div>
        </div>
      </div>
      <div>
        <div class="flex justify-between mb-1 text-white">
          <span>GOOGL</span>
          <span class="font-bold font-mono text-emerald-400">0.11</span>
        </div>
        <div class="h-3 rounded-full bg-slate-700">
          <div class="h-3 rounded-full bg-sky-500" style="width:2%"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="bloomberg-card p-5">
    <h3 class="font-semibold text-amber-400 mb-4">Debt Health Assessment</h3>
    <div class="space-y-3">
      <div class="p-3 rounded-lg border-l-4 border-emerald-500 bg-emerald-500/10">
        <p class="font-medium text-emerald-400">Strong Interest Coverage</p>
        <p class="text-sm text-slate-400">29.8x coverage ratio easily services debt obligations</p>
      </div>
      <div class="p-3 rounded-lg border-l-4 border-emerald-500 bg-emerald-500/10">
        <p class="font-medium text-emerald-400">High Credit Rating</p>
        <p class="text-sm text-slate-400">AA+ rating ensures access to low-cost capital</p>
      </div>
      <div class="p-3 rounded-lg border-l-4 border-sky-500 bg-sky-500/10">
        <p class="font-medium text-sky-400">Well-Laddered Maturities</p>
        <p class="text-sm text-slate-400">No concentration risk in debt maturities</p>
      </div>
      <div class="p-3 rounded-lg border-l-4 border-amber-500 bg-amber-500/10">
        <p class="font-medium text-amber-400">Rising Rate Exposure</p>
        <p class="text-sm text-slate-400">$7B maturing in 2025 may refinance at higher rates</p>
      </div>
    </div>
  </div>
</div>
</div></div></main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById('debtChart'), {
  type: 'doughnut',
  data: { labels: ['Senior Notes','Commercial Paper','Term Loans'], datasets: [{ data: [95.4,12.2,3.5], backgroundColor: ['#0ea5e9','#8b5cf6','#f59e0b'] }] },
  options: { responsive: true, maintainAspectRatio: false }
});
new Chart(document.getElementById('maturityChart'), {
  type: 'bar',
  data: { labels: ['2025','2026','2027','2028','2029','2030+'], datasets: [{ label: 'Amount ($B)', data: [7.0,8.5,12.4,15.2,18.6,49.4], backgroundColor: '#0ea5e9' }] },
  options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
});
</script>
<%- include('../partials/footer') %>
