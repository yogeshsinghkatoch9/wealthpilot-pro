<%
// Safe defaults for all potentially undefined variables
const safeTheme = typeof theme !== 'undefined' ? theme : 'dark';
const safePageTitle = typeof pageTitle !== 'undefined' ? pageTitle : 'Corporate Actions';
%>
<%- include('../partials/header', { pageTitle: safePageTitle }) %>

<!-- Bloomberg Header Bar -->
<div class="bloomberg-header mb-6">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-amber-400 mb-1">CORPORATE ACTIONS</h1>
      <p class="<%= safeTheme === 'light' ? 'text-gray-600' : 'text-slate-400' %> text-sm">Splits, spinoffs, mergers & acquisitions</p>
    </div>
    <div class="flex gap-2">
      <select class="form-input w-32 font-mono text-sm"><option selected>My Holdings</option><option>Watchlist</option><option>All Markets</option></select>
      <select class="form-input w-28 font-mono text-sm"><option selected>All Types</option><option>Splits</option><option>M&A</option><option>Spinoffs</option></select>
    </div>
  </div>
</div>

<!-- Upcoming Actions -->
<div class="tufte-stat-card p-5 <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800/50' %>">
<h3 class="font-semibold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4 uppercase tracking-wide">Upcoming Corporate Actions Affecting Your Portfolio</h3>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="p-4 rounded-lg <%= safeTheme === 'light' ? 'bg-white' : 'bg-slate-800' %> border-l-4 border-purple-500">
<div class="flex justify-between items-start mb-2">
<span class="font-bold text-purple-400 font-mono">NVDA</span>
<span class="text-xs <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> font-mono">Dec 15</span>
</div>
<p class="font-medium <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">10-for-1 Stock Split</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mt-1 font-mono">Your 50 shares ‚Üí 500 shares</p>
<p class="text-xs text-emerald-400 mt-2">No action required</p>
</div>
<div class="p-4 rounded-lg <%= safeTheme === 'light' ? 'bg-white' : 'bg-slate-800' %> border-l-4 border-sky-500">
<div class="flex justify-between items-start mb-2">
<span class="font-bold text-sky-400 font-mono">JNJ</span>
<span class="text-xs <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> font-mono">Jan 3</span>
</div>
<p class="font-medium <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">Kenvue Spinoff Complete</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mt-1 font-mono">Receive KVUE shares</p>
<p class="text-xs text-amber-400 mt-2">Tax implications</p>
</div>
<div class="p-4 rounded-lg <%= safeTheme === 'light' ? 'bg-white' : 'bg-slate-800' %> border-l-4 border-emerald-500">
<div class="flex justify-between items-start mb-2">
<span class="font-bold text-emerald-400 font-mono">GOOGL</span>
<span class="text-xs <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> font-mono">Jan 15</span>
</div>
<p class="font-medium <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">Special Dividend</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mt-1 tabular-nums">$2.50/share one-time</p>
<p class="text-xs text-emerald-400 mt-2 tabular-nums">$125 to your account</p>
</div>
</div>
</div>

<!-- Recent Actions Table -->
<div class="tufte-stat-card overflow-hidden">
<div class="p-4 border-b <%= safeTheme === 'light' ? 'border-gray-200' : 'border-slate-700' %>">
<h3 class="font-semibold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %> uppercase tracking-wide">Recent Corporate Actions</h3>
</div>
<table class="bloomberg-table w-full text-sm">
<thead>
<tr class="<%= safeTheme === 'light' ? 'bg-gray-50 text-gray-500' : 'bg-slate-800 text-slate-400' %> text-left">
<th class="px-4 py-3 uppercase text-xs font-mono tracking-wider">Date</th>
<th class="px-4 py-3 uppercase text-xs font-mono tracking-wider">Company</th>
<th class="px-4 py-3 uppercase text-xs font-mono tracking-wider">Type</th>
<th class="px-4 py-3 uppercase text-xs font-mono tracking-wider">Details</th>
<th class="px-4 py-3 text-center uppercase text-xs font-mono tracking-wider">Impact</th>
<th class="px-4 py-3 uppercase text-xs font-mono tracking-wider">Status</th>
</tr>
</thead>
<tbody class="<%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">
<tr class="border-b <%= safeTheme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3 font-mono">Dec 15</td>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gray-100" : "bg-slate-800 flex items-center justify-center text-white text-xs font-bold font-mono">NVDA</div><span class="font-medium">NVIDIA</span></div></td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-bold font-mono">SPLIT</span></td>
<td class="px-4 py-3">10-for-1 stock split</td>
<td class="px-4 py-3 text-center text-emerald-400 tabular-nums">50 ‚Üí 500 shares</td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-mono">Pending</span></td>
</tr>
<tr class="border-b <%= safeTheme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3 font-mono">Dec 8</td>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded <%= safeTheme === 'light' ? 'bg-gray-100' : 'bg-slate-800' %> flex items-center justify-center text-white text-xs font-bold font-mono">VMW</div><span class="font-medium">VMware</span></div></td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-bold font-mono">M&A</span></td>
<td class="px-4 py-3">Acquired by Broadcom</td>
<td class="px-4 py-3 text-center tabular-nums">$142.50/share cash</td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-mono">Complete</span></td>
</tr>
<tr class="border-b <%= safeTheme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3 font-mono">Nov 28</td>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded <%= safeTheme === 'light' ? 'bg-gray-100' : 'bg-slate-800' %> flex items-center justify-center text-white text-xs font-bold font-mono">GE</div><span class="font-medium">GE</span></div></td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-bold font-mono">SPINOFF</span></td>
<td class="px-4 py-3">GE Vernova separation</td>
<td class="px-4 py-3 text-center tabular-nums">1 GEV per 4 GE</td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-mono">Complete</span></td>
</tr>
<tr class="border-b <%= safeTheme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3 font-mono">Nov 15</td>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded <%= safeTheme === 'light' ? 'bg-gray-100' : 'bg-slate-800' %> flex items-center justify-center text-white text-xs font-bold font-mono">CMG</div><span class="font-medium">Chipotle</span></div></td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-bold font-mono">SPLIT</span></td>
<td class="px-4 py-3">50-for-1 stock split</td>
<td class="px-4 py-3 text-center tabular-nums">$2,800 ‚Üí $56/share</td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-mono">Complete</span></td>
</tr>
<tr class="border-b <%= safeTheme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3 font-mono">Oct 28</td>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded <%= safeTheme === 'light' ? 'bg-gray-100' : 'bg-slate-800' %> flex items-center justify-center text-white text-xs font-bold font-mono">XOM</div><span class="font-medium">Exxon</span></div></td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-bold font-mono">M&A</span></td>
<td class="px-4 py-3">Acquired Pioneer Natural</td>
<td class="px-4 py-3 text-center tabular-nums">2.32 XOM per PXD</td>
<td class="px-4 py-3"><span class="px-2 py-1 rounded <%= safeTheme === 'light' ? 'bg-gray-100 text-gray-900' : 'bg-slate-800 text-white' %> text-xs font-mono">Complete</span></td>
</tr>
</tbody>
</table>
</div>

<!-- Action Types -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
<div class="tufte-stat-card p-5">
<div class="flex items-center gap-3 mb-3">
<div class="w-10 h-10 rounded-lg <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800/50' %>0/20 flex items-center justify-center text-purple-400 text-xl">‚úÇÔ∏è</div>
<h4 class="font-bold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">Stock Splits</h4>
</div>
<p class="text-2xl font-bold text-purple-400 mb-1">8</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">in your holdings (YTD)</p>
<p class="text-xs text-emerald-400 mt-2">Most recent: NVDA 10:1</p>
</div>
<div class="tufte-stat-card p-5">
<div class="flex items-center gap-3 mb-3">
<div class="w-10 h-10 rounded-lg <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800/50' %>0/20 flex items-center justify-center text-red-400 text-xl">ü§ù</div>
<h4 class="font-bold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">M&A Activity</h4>
</div>
<p class="text-2xl font-bold text-red-400 mb-1">3</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">acquisitions affecting portfolio</p>
<p class="text-xs text-amber-400 mt-2">1 pending: ATVI by MSFT</p>
</div>
<div class="tufte-stat-card p-5">
<div class="flex items-center gap-3 mb-3">
<div class="w-10 h-10 rounded-lg <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800/50' %>0/20 flex items-center justify-center text-sky-400 text-xl">üîÄ</div>
<h4 class="font-bold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">Spinoffs</h4>
</div>
<p class="text-2xl font-bold text-sky-400 mb-1">2</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">new positions received</p>
<p class="text-xs text-emerald-400 mt-2">KVUE from JNJ</p>
</div>
<div class="tufte-stat-card p-5">
<div class="flex items-center gap-3 mb-3">
<div class="w-10 h-10 rounded-lg <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800/50' %>0/20 flex items-center justify-center text-emerald-400 text-xl">üí∞</div>
<h4 class="font-bold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %>">Special Dividends</h4>
</div>
<p class="text-2xl font-bold text-emerald-400 mb-1">$842</p>
<p class="text-sm <%= safeTheme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">received YTD</p>
<p class="text-xs text-emerald-400 mt-2">4 special distributions</p>
</div>
</div>

<!-- Historical Actions -->
<div class="tufte-stat-card p-5">
<h3 class="font-semibold <%= safeTheme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Corporate Action Impact Analysis</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<h4 class="font-medium mb-3 <%= safeTheme === 'light' ? 'text-gray-700' : 'text-slate-300' %>">Split Performance (30-Day Post)</h4>
<div class="space-y-2">
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>NVDA (Jun 2024)</span><span class="positive font-bold">+28.4%</span>
</div>
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>CMG (Jun 2024)</span><span class="positive font-bold">+12.8%</span>
</div>
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>AMZN (Jun 2022)</span><span class="negative font-bold">-8.2%</span>
</div>
</div>
</div>
<div>
<h4 class="font-medium mb-3 <%= safeTheme === 'light' ? 'text-gray-700' : 'text-slate-300' %>">Spinoff Performance</h4>
<div class="space-y-2">
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>KVUE (from JNJ)</span><span class="negative font-bold">-18.4%</span>
</div>
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>GEV (from GE)</span><span class="positive font-bold">+42.6%</span>
</div>
<div class="flex justify-between items-center p-2 rounded <%= safeTheme === 'light' ? 'bg-gray-50' : 'bg-slate-800' %>">
<span>WBD (from T)</span><span class="negative font-bold">-62.4%</span>
</div>
</div>
</div>
</div>
</div>
</div></div></main>
<%- include('../partials/footer') %>
