<%- include('../partials/header', { pageTitle: 'Shorts Report' }) %>

<div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
<div><h1 class="text-2xl font-bold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">Shorts Report</h1><p class="<%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Short interest, days to cover & squeeze potential</p></div>
<div class="flex gap-2">
<select class="form-input w-32"><option selected>My Holdings</option><option>Watchlist</option><option>Most Shorted</option></select>
</div>
</div>

<!-- Short Interest Overview -->
<div class="card p-5 bg-gradient-to-r <%= theme === 'light' ? 'from-red-50 to-amber-50' : 'from-red-900/20 to-amber-900/20' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Portfolio Short Interest Summary</h3>
<div class="grid grid-cols-2 md:grid-cols-5 gap-4">
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Avg Short Interest</p>
<p class="text-3xl font-bold text-amber-400">4.8%</p>
<p class="text-xs text-emerald-400">Below avg</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Highest Short</p>
<p class="text-3xl font-bold text-red-400">TSLA</p>
<p class="text-xs text-red-400">12.4% SI</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Avg Days to Cover</p>
<p class="text-3xl font-bold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">2.4</p>
<p class="text-xs">days</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Squeeze Candidates</p>
<p class="text-3xl font-bold text-purple-400">2</p>
<p class="text-xs text-purple-400">holdings</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">SI Increasing</p>
<p class="text-3xl font-bold text-red-400">5</p>
<p class="text-xs text-red-400">holdings</p>
</div>
</div>
</div>

<!-- Holdings Short Interest Table -->
<div class="card overflow-hidden">
<div class="p-4 border-b <%= theme === 'light' ? 'border-gray-200' : 'border-slate-700' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">Holdings Short Interest</h3>
</div>
<table class="w-full text-sm">
<thead>
<tr class="<%= theme === 'light' ? 'bg-gray-50 text-gray-500' : 'bg-slate-800 text-slate-400' %> text-left">
<th class="px-4 py-3">Stock</th>
<th class="px-4 py-3 text-center">Short Interest</th>
<th class="px-4 py-3 text-center">Shares Short</th>
<th class="px-4 py-3 text-center">Days to Cover</th>
<th class="px-4 py-3 text-center">SI Change</th>
<th class="px-4 py-3 text-center">Borrow Rate</th>
<th class="px-4 py-3 text-center">Squeeze Risk</th>
</tr>
</thead>
<tbody class="<%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center text-white text-xs font-bold">TSLA</div><span class="font-medium">Tesla</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-red-500/20 text-red-400 font-bold">12.4%</span></td>
<td class="px-4 py-3 text-center">98.2M</td>
<td class="px-4 py-3 text-center text-red-400 font-bold">4.2</td>
<td class="px-4 py-3 text-center text-red-400">+2.8%</td>
<td class="px-4 py-3 text-center text-amber-400">8.4%</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-purple-500/20 text-purple-400 text-xs">ELEVATED</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold">NVDA</div><span class="font-medium">NVIDIA</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 font-bold">3.8%</span></td>
<td class="px-4 py-3 text-center">94.8M</td>
<td class="px-4 py-3 text-center">1.8</td>
<td class="px-4 py-3 text-center text-red-400">+0.6%</td>
<td class="px-4 py-3 text-center">0.8%</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">LOW</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">AAPL</div><span class="font-medium">Apple</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 font-bold">0.8%</span></td>
<td class="px-4 py-3 text-center">124.2M</td>
<td class="px-4 py-3 text-center text-emerald-400">1.2</td>
<td class="px-4 py-3 text-center text-emerald-400">-0.2%</td>
<td class="px-4 py-3 text-center text-emerald-400">0.3%</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">MINIMAL</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">MSFT</div><span class="font-medium">Microsoft</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 font-bold">0.6%</span></td>
<td class="px-4 py-3 text-center">44.8M</td>
<td class="px-4 py-3 text-center text-emerald-400">0.8</td>
<td class="px-4 py-3 text-center text-emerald-400">-0.1%</td>
<td class="px-4 py-3 text-center text-emerald-400">0.3%</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">MINIMAL</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-amber-500 to-amber-600 flex items-center justify-center text-white text-xs font-bold">AMD</div><span class="font-medium">AMD</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 font-bold">5.2%</span></td>
<td class="px-4 py-3 text-center">84.2M</td>
<td class="px-4 py-3 text-center">2.4</td>
<td class="px-4 py-3 text-center text-red-400">+1.2%</td>
<td class="px-4 py-3 text-center">1.2%</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs">MODERATE</span></td>
</tr>
</tbody>
</table>
</div>

<!-- Squeeze Candidates -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">ðŸš€ Potential Squeeze Candidates</h3>
<div class="space-y-3">
<div class="p-4 rounded-lg border-l-4 border-purple-500 <%= theme === 'light' ? 'bg-purple-50' : 'bg-purple-500/10' %>">
<div class="flex justify-between items-start">
<div><p class="font-bold">TSLA</p><p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %> mt-1">High SI (12.4%), 4.2 days to cover, rising borrow cost</p></div>
<span class="px-2 py-1 rounded bg-purple-500 text-white text-xs font-bold">WATCH</span>
</div>
</div>
<div class="p-4 rounded-lg border-l-4 border-amber-500 <%= theme === 'light' ? 'bg-amber-50' : 'bg-amber-500/10' %>">
<div class="flex justify-between items-start">
<div><p class="font-bold">AMD</p><p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %> mt-1">Moderate SI (5.2%), increasing short positions</p></div>
<span class="px-2 py-1 rounded bg-amber-500 text-white text-xs font-bold">MONITOR</span>
</div>
</div>
</div>
</div>
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Short Interest Trend</h3>
<div class="h-48"><canvas id="siChart"></canvas></div>
</div>
</div>

<!-- Charts -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Short Interest by Holding</h3>
<div class="h-48"><canvas id="barChart"></canvas></div>
</div>
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Days to Cover Distribution</h3>
<div class="h-48"><canvas id="dtcChart"></canvas></div>
</div>
</div>
</div></div></main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById('siChart'), {
  type: 'line',
  data: { labels: ['Oct','Nov','Dec'], datasets: [
    { label: 'TSLA', data: [9.6,10.8,12.4], borderColor: '#ef4444', fill: false },
    { label: 'AMD', data: [4.0,4.8,5.2], borderColor: '#f59e0b', fill: false },
    { label: 'AAPL', data: [1.0,0.9,0.8], borderColor: '#10b981', fill: false }
  ]},
  options: { responsive: true, maintainAspectRatio: false }
});
new Chart(document.getElementById('barChart'), {
  type: 'bar',
  data: { labels: ['TSLA','AMD','NVDA','GOOGL','AAPL','MSFT'], datasets: [{ data: [12.4,5.2,3.8,2.1,0.8,0.6], backgroundColor: ctx => ctx.raw > 10 ? '#ef4444' : ctx.raw > 4 ? '#f59e0b' : '#10b981' }] },
  options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
});
new Chart(document.getElementById('dtcChart'), {
  type: 'bar',
  data: { labels: ['<1','1-2','2-3','3-4','>4'], datasets: [{ label: 'Holdings', data: [3,5,4,2,2], backgroundColor: '#8b5cf6' }] },
  options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
});
</script>
<%- include('../partials/footer') %>
