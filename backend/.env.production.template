# ============================================
# WealthPilot Pro - Production Environment
# ============================================
# IMPORTANT: Copy this file to .env.production
# and fill in all required values with strong
# secrets before deploying to production.
# ============================================

# ============================================
# Application Configuration
# ============================================
NODE_ENV=production
PORT=3000
BASE_URL=https://yourdomain.com

# ============================================
# Security Secrets (CHANGE ALL OF THESE!)
# ============================================
# Generate with: openssl rand -base64 64
JWT_SECRET=CHANGE_ME_TO_STRONG_RANDOM_SECRET_64_CHARS_MIN
SESSION_SECRET=CHANGE_ME_TO_STRONG_RANDOM_SECRET_64_CHARS_MIN

# ============================================
# Database Configuration
# ============================================
# SQLite (Default - good for single server)
DATABASE_URL=sqlite:./database/wealthpilot.db

# PostgreSQL (Recommended for production scale)
# Uncomment and configure for PostgreSQL:
# DATABASE_URL=postgresql://username:password@host:5432/wealthpilot_prod
# DB_POOL_MIN=2
# DB_POOL_MAX=10

# ============================================
# External API Keys
# ============================================
# Market Data - Alpha Vantage (Get free key at: https://www.alphavantage.co/support/#api-key)
ALPHA_VANTAGE_API_KEY=your_alpha_vantage_api_key_here

# AI Insights - OpenAI (Get key at: https://platform.openai.com/api-keys)
OPENAI_API_KEY=your_openai_api_key_here

# ============================================
# File Upload Configuration
# ============================================
MAX_FILE_SIZE=10485760  # 10MB in bytes
UPLOAD_DIR=./uploads
PDF_OUTPUT_DIR=./generated-pdfs

# ============================================
# Cache Configuration
# ============================================
CACHE_ENABLED=true

# Cache TTLs (in seconds)
CACHE_TTL_MARKET_DATA=300      # 5 minutes
CACHE_TTL_ANALYTICS=900        # 15 minutes
CACHE_TTL_PORTFOLIO=120        # 2 minutes
CACHE_TTL_USER_DATA=600        # 10 minutes
CACHE_TTL_REPORTS=1800         # 30 minutes

# Redis Configuration (Optional - for distributed caching)
# Uncomment if using Redis instead of node-cache:
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=your_redis_password_here
# REDIS_DB=0
# REDIS_KEY_PREFIX=wealthpilot:

# ============================================
# Rate Limiting (Production Settings)
# ============================================
RATE_LIMIT_ENABLED=true

# General API rate limiting
RATE_LIMIT_WINDOW_MS=900000         # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100         # 100 requests per window per IP

# Authentication endpoints (stricter)
RATE_LIMIT_AUTH_WINDOW_MS=900000    # 15 minutes
RATE_LIMIT_AUTH_MAX=10              # 10 login attempts per window

# Market data endpoints
RATE_LIMIT_MARKET_DATA_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MARKET_DATA_MAX=300           # 300 requests per window

# Analytics endpoints
RATE_LIMIT_ANALYTICS_WINDOW_MS=900000    # 15 minutes
RATE_LIMIT_ANALYTICS_MAX=50              # 50 requests per window

# ============================================
# Security Configuration
# ============================================
HELMET_ENABLED=true
XSS_PROTECTION_ENABLED=true
SQL_INJECTION_PROTECTION_ENABLED=true

# CORS Configuration
CORS_ENABLED=true
CORS_ORIGIN=https://yourdomain.com
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# Cookie Security
COOKIE_SECURE=true  # Requires HTTPS
COOKIE_SAME_SITE=strict
COOKIE_HTTP_ONLY=true

# Content Security Policy
CSP_ENABLED=true

# ============================================
# Logging Configuration
# ============================================
LOG_LEVEL=info  # Options: error, warn, info, debug
LOG_TO_FILE=true
LOG_FILE_PATH=./logs/production.log
LOG_MAX_FILE_SIZE=10485760  # 10MB
LOG_MAX_FILES=10

# Error logging to external service (Optional)
# SENTRY_DSN=https://your_sentry_dsn_here
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# Email Configuration (for email reports)
# ============================================
EMAIL_ENABLED=false

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false  # true for 465, false for other ports
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_specific_password_here

# Email Addresses
EMAIL_FROM=noreply@yourdomain.com
EMAIL_FROM_NAME=WealthPilot Pro
EMAIL_REPLY_TO=support@yourdomain.com

# Email Templates
EMAIL_LOGO_URL=https://yourdomain.com/images/logo.png
EMAIL_SUPPORT_URL=https://yourdomain.com/support
EMAIL_UNSUBSCRIBE_URL=https://yourdomain.com/unsubscribe

# ============================================
# WebSocket Configuration
# ============================================
WEBSOCKET_ENABLED=true
WEBSOCKET_PORT=3000  # Same as HTTP port (Socket.io shares)
WEBSOCKET_PATH=/socket.io
WEBSOCKET_PING_TIMEOUT=60000
WEBSOCKET_PING_INTERVAL=25000

# ============================================
# PDF Generation Configuration
# ============================================
PDF_GENERATION_ENABLED=true
PUPPETEER_HEADLESS=true
PUPPETEER_TIMEOUT=30000  # 30 seconds

# Puppeteer executable path (leave blank for bundled Chromium)
# PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser

# ============================================
# AI Insights Configuration
# ============================================
AI_INSIGHTS_ENABLED=true
AI_MODEL=gpt-4  # Options: gpt-4, gpt-3.5-turbo
AI_MAX_TOKENS=2000
AI_TEMPERATURE=0.7

# ============================================
# Background Jobs Configuration
# ============================================
# Cron schedule for automated tasks
PORTFOLIO_SNAPSHOT_CRON=0 0 * * *  # Daily at midnight
PRICE_UPDATE_CRON=0 */6 * * *      # Every 6 hours
CACHE_CLEANUP_CRON=0 2 * * *       # Daily at 2 AM

# ============================================
# Backup Configuration
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_DIR=./backups

# AWS S3 Backup (Optional)
# AWS_ACCESS_KEY_ID=your_aws_access_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key
# AWS_REGION=us-east-1
# AWS_S3_BACKUP_BUCKET=wealthpilot-backups

# ============================================
# Monitoring & Analytics
# ============================================
# Application Performance Monitoring
ENABLE_APM=false
# APM_SERVICE_NAME=wealthpilot-production
# APM_SERVER_URL=http://apm-server:8200

# Google Analytics (Optional)
# GA_TRACKING_ID=UA-XXXXXXXXX-X

# Mixpanel (Optional)
# MIXPANEL_TOKEN=your_mixpanel_token_here

# ============================================
# Feature Flags
# ============================================
ENABLE_PDF_GENERATION=true
ENABLE_AI_INSIGHTS=true
ENABLE_PORTFOLIO_UPLOAD=true
ENABLE_WEBSOCKET=true
ENABLE_EMAIL_REPORTS=false
ENABLE_BROKERAGE_INTEGRATION=false

# ============================================
# Maintenance Mode
# ============================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We are currently performing scheduled maintenance. Please check back soon.

# ============================================
# Performance Tuning
# ============================================
# Node.js Memory Limit (in MB)
NODE_OPTIONS=--max-old-space-size=2048

# Clustering
ENABLE_CLUSTERING=true
CLUSTER_WORKERS=0  # 0 = auto (number of CPU cores)

# ============================================
# Third-Party Integrations (Future)
# ============================================
# Alpaca Trading API
# ALPACA_API_KEY=your_alpaca_api_key
# ALPACA_API_SECRET=your_alpaca_api_secret
# ALPACA_BASE_URL=https://paper-api.alpaca.markets  # or live API

# Interactive Brokers
# IB_HOST=localhost
# IB_PORT=7496
# IB_CLIENT_ID=1

# ============================================
# Development/Debug (Set to false in production!)
# ============================================
DEBUG=false
VERBOSE_LOGGING=false
ENABLE_QUERY_LOGGING=false

# ============================================
# IMPORTANT REMINDERS
# ============================================
# 1. NEVER commit this file with real secrets to Git!
# 2. Use strong, randomly generated secrets for JWT_SECRET and SESSION_SECRET
# 3. Ensure DATABASE_URL points to your production database
# 4. Set CORS_ORIGIN to your actual production domain
# 5. Enable HTTPS in production (COOKIE_SECURE=true)
# 6. Configure backup strategy (local + S3 recommended)
# 7. Set up monitoring (Sentry recommended)
# 8. Review and adjust rate limits based on expected traffic
# 9. Obtain valid API keys for Alpha Vantage and OpenAI
# 10. Test in staging environment before production deployment
# ============================================
