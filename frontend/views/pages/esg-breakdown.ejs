<%- include('../partials/header', { pageTitle: 'ESG Breakdown' }) %>

<div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
<div><h1 class="text-2xl font-bold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">ESG Breakdown</h1><p class="<%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Environmental, Social & Governance scores</p></div>
<div class="flex gap-2">
<select class="form-input w-36"><option selected>My Holdings</option><option>Watchlist</option></select>
<select class="form-input w-36"><option selected>MSCI Ratings</option><option>Sustainalytics</option><option>S&P Global</option></select>
</div>
</div>

<!-- Portfolio ESG Summary -->
<div class="card p-5 bg-gradient-to-r <%= theme === 'light' ? 'from-emerald-50 to-sky-50' : 'from-emerald-900/20 to-sky-900/20' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Portfolio ESG Overview</h3>
<div class="grid grid-cols-2 md:grid-cols-6 gap-4">
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Overall Rating</p>
<p class="text-4xl font-bold text-emerald-400">A</p>
<p class="text-xs">Above Average</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Environmental</p>
<p class="text-3xl font-bold text-emerald-400">7.2</p>
<p class="text-xs text-emerald-400">Leader</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Social</p>
<p class="text-3xl font-bold text-sky-400">6.8</p>
<p class="text-xs">Above Avg</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Governance</p>
<p class="text-3xl font-bold text-purple-400">7.4</p>
<p class="text-xs text-purple-400">Strong</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">AAA/AA Rated</p>
<p class="text-3xl font-bold text-emerald-400">8</p>
<p class="text-xs">of 16 holdings</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Controversies</p>
<p class="text-3xl font-bold text-amber-400">2</p>
<p class="text-xs">minor flags</p>
</div>
</div>
</div>

<!-- ESG Rating Scale -->
<div class="card p-4">
<div class="flex items-center justify-between gap-2 text-xs">
<span class="px-3 py-1 rounded bg-red-500/20 text-red-400">CCC Laggard</span>
<span class="px-3 py-1 rounded bg-amber-500/20 text-amber-400">B Below Avg</span>
<span class="px-3 py-1 rounded bg-yellow-500/20 text-yellow-400">BB Average</span>
<span class="px-3 py-1 rounded bg-sky-500/20 text-sky-400">BBB Above Avg</span>
<span class="px-3 py-1 rounded bg-emerald-500/20 text-emerald-400">A Above Avg</span>
<span class="px-3 py-1 rounded bg-emerald-500/30 text-emerald-400 font-bold">AA Leader</span>
<span class="px-3 py-1 rounded bg-emerald-500/40 text-emerald-400 font-bold">AAA Leader</span>
</div>
</div>

<!-- Holdings ESG Table -->
<div class="card overflow-hidden">
<div class="p-4 border-b <%= theme === 'light' ? 'border-gray-200' : 'border-slate-700' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">Holdings ESG Ratings</h3>
</div>
<table class="w-full text-sm">
<thead>
<tr class="<%= theme === 'light' ? 'bg-gray-50 text-gray-500' : 'bg-slate-800 text-slate-400' %> text-left">
<th class="px-4 py-3">Company</th>
<th class="px-4 py-3 text-center">MSCI Rating</th>
<th class="px-4 py-3 text-center">E Score</th>
<th class="px-4 py-3 text-center">S Score</th>
<th class="px-4 py-3 text-center">G Score</th>
<th class="px-4 py-3 text-center">Trend</th>
<th class="px-4 py-3 text-center">Controversies</th>
</tr>
</thead>
<tbody class="<%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">MSFT</div><span class="font-medium">Microsoft</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-3 py-1 rounded bg-emerald-500/30 text-emerald-400 font-bold">AAA</span></td>
<td class="px-4 py-3 text-center text-emerald-400 font-bold">8.4</td>
<td class="px-4 py-3 text-center text-emerald-400">7.8</td>
<td class="px-4 py-3 text-center text-emerald-400">8.2</td>
<td class="px-4 py-3 text-center text-emerald-400">‚Üë Upgraded</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">None</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">AAPL</div><span class="font-medium">Apple</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 font-bold">AA</span></td>
<td class="px-4 py-3 text-center text-emerald-400">7.6</td>
<td class="px-4 py-3 text-center text-sky-400">6.4</td>
<td class="px-4 py-3 text-center text-emerald-400">7.8</td>
<td class="px-4 py-3 text-center">‚Üí Stable</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs">1 Minor</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold">NVDA</div><span class="font-medium">NVIDIA</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 font-bold">AA</span></td>
<td class="px-4 py-3 text-center text-emerald-400">7.2</td>
<td class="px-4 py-3 text-center text-emerald-400">7.4</td>
<td class="px-4 py-3 text-center text-emerald-400">7.8</td>
<td class="px-4 py-3 text-center text-emerald-400">‚Üë Upgraded</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">None</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center text-white text-xs font-bold">TSLA</div><span class="font-medium">Tesla</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-3 py-1 rounded bg-yellow-500/20 text-yellow-400">BB</span></td>
<td class="px-4 py-3 text-center text-emerald-400">7.8</td>
<td class="px-4 py-3 text-center text-red-400">4.2</td>
<td class="px-4 py-3 text-center text-amber-400">5.4</td>
<td class="px-4 py-3 text-center text-red-400">‚Üì Downgraded</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-red-500/20 text-red-400 text-xs">2 Moderate</span></td>
</tr>
<tr>
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-amber-500 to-amber-600 flex items-center justify-center text-white text-xs font-bold">XOM</div><span class="font-medium">Exxon</span></div></td>
<td class="px-4 py-3 text-center"><span class="px-3 py-1 rounded bg-amber-500/20 text-amber-400">B</span></td>
<td class="px-4 py-3 text-center text-red-400">3.2</td>
<td class="px-4 py-3 text-center text-sky-400">5.8</td>
<td class="px-4 py-3 text-center text-sky-400">6.4</td>
<td class="px-4 py-3 text-center">‚Üí Stable</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs">1 Moderate</span></td>
</tr>
</tbody>
</table>
</div>

<!-- Pillar Breakdown -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="card p-5">
<h4 class="font-bold text-emerald-400 mb-3">üå± Environmental</h4>
<p class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mb-3">Climate, resources, pollution</p>
<div class="space-y-2">
<div class="flex justify-between"><span>Carbon Emissions</span><span class="font-bold text-emerald-400">7.4</span></div>
<div class="flex justify-between"><span>Energy Use</span><span class="font-bold text-emerald-400">7.0</span></div>
<div class="flex justify-between"><span>Water & Waste</span><span class="font-bold text-sky-400">6.8</span></div>
<div class="flex justify-between"><span>Land Use</span><span class="font-bold text-sky-400">6.2</span></div>
</div>
</div>
<div class="card p-5">
<h4 class="font-bold text-sky-400 mb-3">üë• Social</h4>
<p class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mb-3">Labor, community, human rights</p>
<div class="space-y-2">
<div class="flex justify-between"><span>Labor Practices</span><span class="font-bold text-emerald-400">7.2</span></div>
<div class="flex justify-between"><span>Data Privacy</span><span class="font-bold text-sky-400">6.8</span></div>
<div class="flex justify-between"><span>Diversity & Inclusion</span><span class="font-bold text-sky-400">6.4</span></div>
<div class="flex justify-between"><span>Supply Chain</span><span class="font-bold text-amber-400">5.8</span></div>
</div>
</div>
<div class="card p-5">
<h4 class="font-bold text-purple-400 mb-3">üèõÔ∏è Governance</h4>
<p class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mb-3">Board, ethics, transparency</p>
<div class="space-y-2">
<div class="flex justify-between"><span>Board Independence</span><span class="font-bold text-emerald-400">7.8</span></div>
<div class="flex justify-between"><span>Executive Pay</span><span class="font-bold text-sky-400">6.8</span></div>
<div class="flex justify-between"><span>Audit & Risk</span><span class="font-bold text-emerald-400">7.4</span></div>
<div class="flex justify-between"><span>Business Ethics</span><span class="font-bold text-emerald-400">7.2</span></div>
</div>
</div>
</div>

<!-- Controversies -->
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">‚ö†Ô∏è Active Controversies</h3>
<div class="space-y-3">
<div class="p-4 rounded-lg border-l-4 border-amber-500 <%= theme === 'light' ? 'bg-amber-50' : 'bg-amber-500/10' %>">
<div class="flex justify-between items-start">
<div>
<span class="font-bold">AAPL</span>
<span class="text-xs ml-2 px-2 py-0.5 rounded bg-amber-500/20 text-amber-400">Minor</span>
</div>
<span class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">Oct 2024</span>
</div>
<p class="text-sm mt-1 <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Supply chain labor practices concerns in Southeast Asia</p>
</div>
<div class="p-4 rounded-lg border-l-4 border-red-500 <%= theme === 'light' ? 'bg-red-50' : 'bg-red-500/10' %>">
<div class="flex justify-between items-start">
<div>
<span class="font-bold">TSLA</span>
<span class="text-xs ml-2 px-2 py-0.5 rounded bg-red-500/20 text-red-400">Moderate</span>
</div>
<span class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %>">Nov 2024</span>
</div>
<p class="text-sm mt-1 <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Workplace safety and governance concerns, executive conduct scrutiny</p>
</div>
</div>
</div>

<!-- Charts -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Portfolio ESG Distribution</h3>
<div class="h-48"><canvas id="ratingChart"></canvas></div>
</div>
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">E/S/G Pillar Comparison</h3>
<div class="h-48"><canvas id="pillarChart"></canvas></div>
</div>
</div>
</div></div></main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById('ratingChart'), {
  type: 'doughnut',
  data: { labels: ['AAA','AA','A','BBB','BB','B'], datasets: [{ data: [3,5,4,2,1,1], backgroundColor: ['#10b981','#34d399','#0ea5e9','#f59e0b','#fbbf24','#ef4444'] }] },
  options: { responsive: true, maintainAspectRatio: false }
});
new Chart(document.getElementById('pillarChart'), {
  type: 'radar',
  data: { labels: ['Carbon','Energy','Water','Labor','Privacy','D&I','Board','Ethics','Pay'], datasets: [
    { label: 'Portfolio', data: [7.4,7.0,6.8,7.2,6.8,6.4,7.8,7.2,6.8], borderColor: '#0ea5e9', backgroundColor: 'rgba(14,165,233,0.2)' },
    { label: 'S&P 500', data: [5.8,5.4,5.2,5.8,5.6,5.4,6.2,5.8,5.6], borderColor: '#94a3b8', backgroundColor: 'rgba(148,163,184,0.1)' }
  ]},
  options: { responsive: true, maintainAspectRatio: false, scales: { r: { min: 0, max: 10 } } }
});
</script>
<%- include('../partials/footer') %>
