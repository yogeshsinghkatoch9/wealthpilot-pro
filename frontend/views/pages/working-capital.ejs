<%- include('../partials/header', { pageTitle: 'Working Capital' }) %>

<div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
<div><h1 class="text-2xl font-bold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">Working Capital Analysis</h1><p class="<%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Liquidity ratios & short-term financial health</p></div>
<div class="flex gap-2">
<select class="form-input w-36"><option selected>My Holdings</option><option>Watchlist</option></select>
</div>
</div>

<!-- Working Capital Summary -->
<div class="card p-5 bg-gradient-to-r <%= theme === 'light' ? 'from-sky-50 to-emerald-50' : 'from-sky-900/20 to-emerald-900/20' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Portfolio Liquidity Overview</h3>
<div class="grid grid-cols-2 md:grid-cols-5 gap-4">
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Avg Current Ratio</p>
<p class="text-3xl font-bold text-emerald-400">1.82</p>
<p class="text-xs text-emerald-400">Healthy</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Avg Quick Ratio</p>
<p class="text-3xl font-bold text-sky-400">1.48</p>
<p class="text-xs">Strong</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Avg Cash Ratio</p>
<p class="text-3xl font-bold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">0.84</p>
<p class="text-xs">Good</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Strong Liquidity</p>
<p class="text-3xl font-bold text-emerald-400">12</p>
<p class="text-xs">ratio > 1.5</p>
</div>
<div class="text-center">
<p class="text-sm <%= theme === 'light' ? 'text-gray-600' : 'text-slate-400' %>">Weak Liquidity</p>
<p class="text-3xl font-bold text-red-400">2</p>
<p class="text-xs text-red-400">ratio < 1.0</p>
</div>
</div>
</div>

<!-- Ratio Scale -->
<div class="card p-4">
<p class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mb-2">Current Ratio = Current Assets / Current Liabilities (>1.5 is healthy)</p>
<div class="flex items-center justify-between text-xs">
<div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-red-500"></div><span><1.0 Weak</span></div>
<div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-amber-500"></div><span>1.0-1.5 Adequate</span></div>
<div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-emerald-500"></div><span>1.5-2.5 Healthy</span></div>
<div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-sky-500"></div><span>>2.5 Very Strong</span></div>
</div>
</div>

<!-- Holdings Working Capital Table -->
<div class="card overflow-hidden">
<div class="p-4 border-b <%= theme === 'light' ? 'border-gray-200' : 'border-slate-700' %>">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">Holdings Liquidity Ratios</h3>
</div>
<table class="w-full text-sm">
<thead>
<tr class="<%= theme === 'light' ? 'bg-gray-50 text-gray-500' : 'bg-slate-800 text-slate-400' %> text-left">
<th class="px-4 py-3">Company</th>
<th class="px-4 py-3 text-center">Current Assets</th>
<th class="px-4 py-3 text-center">Current Liab</th>
<th class="px-4 py-3 text-center">Working Cap</th>
<th class="px-4 py-3 text-center">Current Ratio</th>
<th class="px-4 py-3 text-center">Quick Ratio</th>
<th class="px-4 py-3 text-center">Cash Ratio</th>
<th class="px-4 py-3 text-center">Status</th>
</tr>
</thead>
<tbody class="<%= theme === 'light' ? 'text-gray-900' : 'text-white' %>">
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold">NVDA</div><span class="font-medium">NVIDIA</span></div></td>
<td class="px-4 py-3 text-center">$44.2B</td>
<td class="px-4 py-3 text-center">$10.8B</td>
<td class="px-4 py-3 text-center font-bold text-emerald-400">$33.4B</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-sky-500/20 text-sky-400 font-bold">4.09</span></td>
<td class="px-4 py-3 text-center text-emerald-400">3.84</td>
<td class="px-4 py-3 text-center text-emerald-400">2.42</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">Excellent</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">GOOGL</div><span class="font-medium">Alphabet</span></div></td>
<td class="px-4 py-3 text-center">$164.8B</td>
<td class="px-4 py-3 text-center">$68.4B</td>
<td class="px-4 py-3 text-center font-bold text-emerald-400">$96.4B</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 font-bold">2.41</span></td>
<td class="px-4 py-3 text-center text-emerald-400">2.28</td>
<td class="px-4 py-3 text-center text-emerald-400">1.42</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-emerald-500/20 text-emerald-400 text-xs">Strong</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">AAPL</div><span class="font-medium">Apple</span></div></td>
<td class="px-4 py-3 text-center">$143.6B</td>
<td class="px-4 py-3 text-center">$145.3B</td>
<td class="px-4 py-3 text-center font-bold text-red-400">-$1.7B</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 font-bold">0.99</span></td>
<td class="px-4 py-3 text-center text-amber-400">0.94</td>
<td class="px-4 py-3 text-center">0.42</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs">Adequate</span></td>
</tr>
<tr class="border-b <%= theme === 'light' ? 'border-gray-100' : 'border-slate-700/50' %>">
<td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center text-white text-xs font-bold">BA</div><span class="font-medium">Boeing</span></div></td>
<td class="px-4 py-3 text-center">$104.2B</td>
<td class="px-4 py-3 text-center">$118.4B</td>
<td class="px-4 py-3 text-center font-bold text-red-400">-$14.2B</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-red-500/20 text-red-400 font-bold">0.88</span></td>
<td class="px-4 py-3 text-center text-red-400">0.42</td>
<td class="px-4 py-3 text-center text-red-400">0.14</td>
<td class="px-4 py-3 text-center"><span class="px-2 py-1 rounded bg-red-500/20 text-red-400 text-xs">Weak</span></td>
</tr>
</tbody>
</table>
</div>

<!-- Liquidity Insights -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="card p-5">
<h4 class="font-bold text-emerald-400 mb-3">üí™ Best Liquidity</h4>
<div class="space-y-2">
<div class="flex justify-between"><span>NVDA</span><span class="font-bold text-emerald-400">4.09x</span></div>
<div class="flex justify-between"><span>META</span><span class="font-bold text-emerald-400">2.84x</span></div>
<div class="flex justify-between"><span>GOOGL</span><span class="font-bold text-emerald-400">2.41x</span></div>
</div>
</div>
<div class="card p-5">
<h4 class="font-bold text-sky-400 mb-3">üí∞ Most Cash</h4>
<p class="text-xs <%= theme === 'light' ? 'text-gray-500' : 'text-slate-400' %> mb-3">Cash & equivalents</p>
<div class="space-y-2">
<div class="flex justify-between"><span>AAPL</span><span class="font-bold">$61.6B</span></div>
<div class="flex justify-between"><span>GOOGL</span><span class="font-bold">$97.2B</span></div>
<div class="flex justify-between"><span>MSFT</span><span class="font-bold">$80.4B</span></div>
</div>
</div>
<div class="card p-5">
<h4 class="font-bold text-red-400 mb-3">‚ö†Ô∏è Liquidity Concerns</h4>
<div class="space-y-2">
<div class="flex justify-between"><span>BA</span><span class="font-bold text-red-400">0.88x</span></div>
<div class="flex justify-between"><span>AAPL</span><span class="font-bold text-amber-400">0.99x</span></div>
<div class="flex justify-between"><span>T</span><span class="font-bold text-amber-400">0.72x</span></div>
</div>
</div>
</div>

<!-- Charts -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Current Ratio by Holding</h3>
<div class="h-48"><canvas id="ratioChart"></canvas></div>
</div>
<div class="card p-5">
<h3 class="font-semibold <%= theme === 'light' ? 'text-gray-900' : 'text-white' %> mb-4">Working Capital Trend (AAPL)</h3>
<div class="h-48"><canvas id="trendChart"></canvas></div>
</div>
</div>
</div></div></main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById('ratioChart'), {
  type: 'bar',
  data: { labels: ['NVDA','META','GOOGL','MSFT','JNJ','AAPL','T','BA'], datasets: [
    { label: 'Current Ratio', data: [4.09,2.84,2.41,1.84,1.42,0.99,0.72,0.88], backgroundColor: d => d.raw > 1.5 ? '#10b981' : d.raw > 1.0 ? '#f59e0b' : '#ef4444' }
  ]},
  options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
});
new Chart(document.getElementById('trendChart'), {
  type: 'line',
  data: { labels: ['2020','2021','2022','2023','2024'], datasets: [
    { label: 'Current Ratio', data: [1.36,1.14,0.88,0.94,0.99], borderColor: '#f59e0b', fill: false },
    { label: 'Quick Ratio', data: [1.31,1.08,0.82,0.88,0.94], borderColor: '#0ea5e9', fill: false }
  ]},
  options: { responsive: true, maintainAspectRatio: false }
});
</script>
<%- include('../partials/footer') %>
